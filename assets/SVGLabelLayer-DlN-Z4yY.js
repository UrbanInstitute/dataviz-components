import{B as ee,bj as he,bk as _e,bl as xe,bm as we,G as ge,o as Ee,bn as Ce,M as Pe,bo as Se,I as Ve,n as N,bp as te,bq as ie,br as Le,p as Fe,g as v,Q as J,a as K,y as j,b as O,d as Oe,R as Ae,h as fe,c as Q,s as ze,t as I,i as m,x as ae,a5 as ne,Y as Te,P as oe,e as re}from"./iframe-BjxEKEQH.js";import{e as Ge,i as We}from"./each-DC_8OmU5.js";import{s as y}from"./attributes-UJeNkN1P.js";import{s as U}from"./style-CNURdi_Z.js";import{u as se}from"./urbanColors-BkxYcPwH.js";import{u as Me,r as le,d as Ne}from"./lib-CgGEPiW4.js";const je=()=>performance.now(),x={tick:t=>requestAnimationFrame(t),now:()=>je(),tasks:new Set};function ce(){const t=x.now();x.tasks.forEach(e=>{e.c(t)||(x.tasks.delete(e),e.f())}),x.tasks.size!==0&&x.tick(ce)}function Re(t){let e;return x.tasks.size===0&&x.tick(ce),{promise:new Promise(i=>{x.tasks.add(e={c:t,f:i})}),abort(){x.tasks.delete(e)}}}function Z(t,e){Pe(()=>{t.dispatchEvent(new CustomEvent(e))})}function qe(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(i=>i[0].toUpperCase()+i.slice(1)).join("")}function de(t){const e={},i=t.split(";");for(const o of i){const[f,b]=o.split(":");if(!f||b===void 0)break;const u=qe(f.trim());e[u]=b.trim()}return e}const Be=t=>t;function Ie(t,e,i,o){var f=(t&Ce)!==0,b="both",u,E=e.inert,A=e.style.overflow,l,s;function w(){var n=Le,P=ee;te(null),ie(null);try{return u??(u=i()(e,(o==null?void 0:o())??{},{direction:b}))}finally{te(n),ie(P)}}var C={is_global:f,in(){e.inert=E,Z(e,"introstart"),l=Y(e,w(),s,1,()=>{Z(e,"introend"),l==null||l.abort(),l=u=void 0,e.style.overflow=A})},out(n){e.inert=!0,Z(e,"outrostart"),s=Y(e,w(),l,0,()=>{Z(e,"outroend"),n==null||n()})},stop:()=>{l==null||l.abort(),s==null||s.abort()}},_=ee;if((_.transitions??(_.transitions=[])).push(C),he){var h=f;if(!h){for(var a=_.parent;a&&(a.f&_e)!==0;)for(;(a=a.parent)&&(a.f&xe)===0;);h=!a||(a.f&we)!==0}h&&ge(()=>{Ee(()=>C.in())})}}function Y(t,e,i,o,f){var b=o===1;if(Se(e)){var u,E=!1;return Ve(()=>{if(!E){var n=e({direction:b?"in":"out"});u=Y(t,n,i,o,f)}}),{abort:()=>{E=!0,u==null||u.abort()},deactivate:()=>u.deactivate(),reset:()=>u.reset(),t:()=>u.t()}}if(i==null||i.deactivate(),!(e!=null&&e.duration))return f(),{abort:N,deactivate:N,reset:N,t:()=>o};const{delay:A=0,css:l,tick:s,easing:w=Be}=e;var C=[];if(b&&i===void 0&&(s&&s(0,1),l)){var _=de(l(0,1));C.push(_,_)}var h=()=>1-o,a=t.animate(C,{duration:A,fill:"forwards"});return a.onfinish=()=>{a.cancel();var n=(i==null?void 0:i.t())??1-o;i==null||i.abort();var P=o-n,z=e.duration*Math.abs(P),R=[];if(z>0){var T=!1;if(l)for(var G=Math.ceil(z/16.666666666666668),W=0;W<=G;W+=1){var q=n+P*w(W/G),d=de(l(q,1-q));R.push(d),T||(T=d.overflow==="hidden")}T&&(t.style.overflow="hidden"),h=()=>{var r=a.currentTime;return n+P*w(r/z)},s&&Re(()=>{if(a.playState!=="running")return!1;var r=h();return s(r,1-r),!0})}a=t.animate(R,{duration:z,fill:"forwards"}),a.onfinish=()=>{h=()=>o,s==null||s(o,1-o),f()}},{abort:()=>{a&&(a.cancel(),a.effect=null,a.onfinish=N)},deactivate:()=>{f=N},reset:()=>{o===0&&(s==null||s(1,0))},t:()=>h()}}const Ze=t=>t;function De(t,{delay:e=0,duration:i=400,easing:o=Ze}={}){const f=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:o,css:b=>`opacity: ${b*f}`}}var Je=(t,e,i)=>e(t,m(i)),Ke=(t,e,i)=>e(t,m(i)),Qe=fe('<g class="label-feature"><text stroke-linejoin="round" role="presentation"><!></text><text><!></text></g>'),Ue=fe('<g class="map-layer label-layer" role="presentation"></g>');function Ye(t,e){Fe(e,!0);let i=v(e,"features",3,void 0),o=v(e,"fontColor",19,()=>se.white),f=v(e,"fontSize",3,12),b=v(e,"stroke",19,()=>se.black),u=v(e,"strokeWidth",3,3),E=v(e,"textAnchor",3,"middle"),A=v(e,"dy",3,"-.5em"),l=v(e,"minZoom",3,0),s=v(e,"pointerEvents",3,!0),w=v(e,"tooltip",3,!1),C=v(e,"onclick",3,void 0),_=v(e,"onmousemove",3,void 0),h=v(e,"onmouseout",3,void 0),a=v(e,"children",3,void 0);const n=Me(),P=ae(()=>Ne(n.projection));function z(d,r){var g;le(d.target),n.onPointerMove(d,r.properties,{tooltip:w()}),(g=_())==null||g(new CustomEvent("mousemove",{detail:{e:d,props:r.properties}}))}function R(d,r){var g;le(d.target),n.onPointerDown(d,r.properties,{tooltip:w()}),(g=C())==null||g(new CustomEvent("click",{detail:{e:d,props:r.properties}}))}function T(d){var r;n.onPointerOut(d),(r=h())==null||r(new CustomEvent("mouseout",{detail:{e:d}}))}var G=J(),W=K(G);{var q=d=>{var r=Ue();r.__pointerout=T;let g;Ge(r,21,()=>i()||n.features,We,(ue,S)=>{var H=Qe();const B=ae(()=>{const[c,k]=m(P).centroid(m(S));return{x:c,y:k}});var p=Q(H);y(p,"opacity",.5),p.__pointermove=[Je,z,S],p.__pointerdown=[Ke,R,S];let X;var ve=Q(p);{var pe=c=>{var k=J(),L=K(k);ne(L,a,()=>m(S).properties),O(c,k)},ye=(c,k)=>{{var L=F=>{var M=oe();I(D=>re(M,D),[()=>e.getLabel(m(S))]),O(F,M)};j(c,F=>{e.getLabel&&F(L)},k)}};j(ve,c=>{a()?c(pe):c(ye,!1)})}var V=ze(p);let $;var me=Q(V);{var be=c=>{var k=J(),L=K(k);ne(L,a,()=>m(S).properties),O(c,k)},ke=(c,k)=>{{var L=F=>{var M=oe();I(D=>re(M,D),[()=>e.getLabel(m(S))]),O(F,M)};j(c,F=>{e.getLabel&&F(L)},k)}};j(me,c=>{a()?c(be):c(ke,!1)})}I(()=>{y(p,"x",m(B).x),y(p,"y",m(B).y),y(p,"dy",A()),y(p,"stroke-width",`${u()/n.transform.k}px`),y(p,"stroke",b()),y(p,"text-anchor",E()),X=U(p,"",X,{"font-size":`${f()/n.transform.k}px`}),y(V,"x",m(B).x),y(V,"y",m(B).y),y(V,"dy",A()),y(V,"fill",o()),y(V,"text-anchor",E()),$=U(V,"",$,{"font-size":`${f()/n.transform.k}px`})}),O(ue,H)}),I(()=>g=U(r,"",g,{"pointer-events":s()?"auto":"none"})),Te("blur",r,T),Ie(3,r,()=>De,()=>({duration:250})),O(d,r)};j(W,d=>{(!l()||n.transform.k>=l())&&d(q)})}O(t,G),Oe()}Ae(["pointerout","pointermove","pointerdown"]);Ye.__docgen={data:[{name:"features",visibility:"public",description:"A list of GeoJSON features rendered as labels.",keywords:[],kind:"let",type:{kind:"type",type:"array",text:"GeoPermissibleObjects[]"},static:!1,readonly:!1},{name:"fontColor",visibility:"public",description:"Color of the text label.",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"fontSize",visibility:"public",description:"Font size of the label text.",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"12"},{name:"stroke",visibility:"public",description:"Color of the text outline.",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"strokeWidth",visibility:"public",description:"Width of the text outline.",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"3"},{name:"textAnchor",visibility:"public",description:"Text anchor value for the label.",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"middle"'},{name:"dy",visibility:"public",description:"SVG `dy` offset applied to the label.",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"-.5em"'},{name:"minZoom",visibility:"public",description:"Minimum zoom factor at which to render the layer.",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"0"},{name:"pointerEvents",visibility:"public",description:"Whether the layer responds to pointer events.",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"true"},{name:"getLabel",visibility:"public",description:"Function that returns the label text for a feature.",keywords:[],kind:"let",type:{kind:"function",text:"(feature: any) => string"},static:!1,readonly:!1},{name:"tooltip",visibility:"public",description:"Whether the layer should populate the tooltip slot.",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"onclick",visibility:"public",description:"Optional click callback.",keywords:[],kind:"let",type:{kind:"function",text:"(event: CustomEvent<{ e: PointerEvent; props: any; }>) => void"},static:!1,readonly:!1},{name:"onmousemove",visibility:"public",description:"Optional mousemove callback.",keywords:[],kind:"let",type:{kind:"function",text:"(event: CustomEvent<{ e: PointerEvent; props: any; }>) => void"},static:!1,readonly:!1},{name:"onmouseout",visibility:"public",description:"Optional mouseout callback.",keywords:[],kind:"let",type:{kind:"function",text:"(event: CustomEvent<{ e: PointerEvent; }>) => void"},static:!1,readonly:!1},{name:"children",visibility:"public",description:"Optional snippet to render label content.",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[props: any]>"},static:!1,readonly:!1}],name:"SVGLabelLayer.svelte"};export{Ye as S};
