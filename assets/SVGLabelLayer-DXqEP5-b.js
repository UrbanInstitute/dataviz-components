import{z as me,S as ye,i as he,s as _e,t as w,b as V,j as ne,l as O,h as le,y as be,A as N,r as se,q as T,u as J,v as H,w as I}from"./index-Dy1J9qof.js";import{m as K,i as j,d as k,x as ke,A as ge,o as G,p as P,b as B,j as u,f as E,v as M,n as ve,k as Q,t as ae,g as re,l as fe}from"./lifecycle-mCW1c9RL.js";import{e as R}from"./each-CjkgdRJJ.js";import{u as U}from"./urbanColors-BkxYcPwH.js";import{g as we,r as X,d as Y}from"./lib-CRabK7jd.js";function x(e,{delay:i=0,duration:t=400,easing:o=me}={}){const a=+getComputedStyle(e).opacity;return{delay:i,duration:t,easing:o,css:c=>`opacity: ${c*a}`}}function $(e,i,t){const o=e.slice();o[29]=i[t];const a=o[10].centroid(o[29]);return o[30]=a[0],o[31]=a[1],o}const ze=e=>({props:e[0]&4097}),ee=e=>({props:e[29].properties}),Ce=e=>({props:e[0]&4097}),te=e=>({props:e[29].properties});function ie(e){let i,t,o,a,c,h=R(e[0]||e[12]),s=[];for(let r=0;r<h.length;r+=1)s[r]=oe($(e,h,r));const _=r=>V(s[r],1,1,()=>{s[r]=null});return{c(){i=G("g");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){i=P(r,"g",{class:!0});var d=B(i);for(let n=0;n<s.length;n+=1)s[n].l(d);d.forEach(k),this.h()},h(){u(i,"class","map-layer label-layer"),E(i,"pointer-events",e[8]?"auto":"none")},m(r,d){j(r,i,d);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(i,null);o=!0,a||(c=[M(i,"mouseout",e[25]),M(i,"blur",e[26])],a=!0)},p(r,d){if(d[0]&2498175){h=R(r[0]||r[12]);let n;for(n=0;n<h.length;n+=1){const g=$(r,h,n);s[n]?(s[n].p(g,d),w(s[n],1)):(s[n]=oe(g),s[n].c(),w(s[n],1),s[n].m(i,null))}for(le(),n=h.length;n<s.length;n+=1)_(n);ne()}d[0]&256&&E(i,"pointer-events",r[8]?"auto":"none")},i(r){if(!o){for(let d=0;d<h.length;d+=1)w(s[d]);r&&be(()=>{o&&(t||(t=N(i,x,{duration:250},!0)),t.run(1))}),o=!0}},o(r){s=s.filter(Boolean);for(let d=0;d<s.length;d+=1)V(s[d]);r&&(t||(t=N(i,x,{duration:250},!1)),t.run(0)),o=!1},d(r){r&&k(i),ve(s,r),r&&t&&t.end(),a=!1,se(c)}}}function Se(e){let i=e[9](e[29])+"",t;return{c(){t=ae(i)},l(o){t=re(o,i)},m(o,a){j(o,t,a)},p(o,a){a[0]&4609&&i!==(i=o[9](o[29])+"")&&fe(t,i)},d(o){o&&k(t)}}}function Ae(e){let i=e[9](e[29])+"",t;return{c(){t=ae(i)},l(o){t=re(o,i)},m(o,a){j(o,t,a)},p(o,a){a[0]&4609&&i!==(i=o[9](o[29])+"")&&fe(t,i)},d(o){o&&k(t)}}}function oe(e){let i,t,o,a,c,h=`${e[2]/e[11].k}px`,s,_,r,d=`${e[2]/e[11].k}px`,n,g,W;const A=e[22].default,z=T(A,e,e[21],te),m=z||Se(e);function F(...p){return e[23](e[29],...p)}function Z(...p){return e[24](e[29],...p)}const L=e[22].default,C=T(L,e,e[21],ee),y=C||Ae(e);return{c(){i=G("g"),t=G("text"),m&&m.c(),s=G("text"),y&&y.c(),this.h()},l(p){i=P(p,"g",{class:!0});var f=B(i);t=P(f,"text",{x:!0,y:!0,dy:!0,"stroke-width":!0,stroke:!0,opacity:!0,"stroke-linejoin":!0,"text-anchor":!0});var S=B(t);m&&m.l(S),S.forEach(k),s=P(f,"text",{x:!0,y:!0,dy:!0,fill:!0,"text-anchor":!0});var v=B(s);y&&y.l(v),v.forEach(k),f.forEach(k),this.h()},h(){u(t,"x",o=e[30]),u(t,"y",a=e[31]),u(t,"dy",e[6]),u(t,"stroke-width",c=e[4]/e[11].k+"px"),u(t,"stroke",e[3]),u(t,"opacity",.5),u(t,"stroke-linejoin","round"),u(t,"text-anchor",e[5]),E(t,"font-size",h),u(s,"x",_=e[30]),u(s,"y",r=e[31]),u(s,"dy",e[6]),u(s,"fill",e[1]),u(s,"text-anchor",e[5]),E(s,"font-size",d),u(i,"class","label-feature")},m(p,f){j(p,i,f),Q(i,t),m&&m.m(t,null),Q(i,s),y&&y.m(s,null),n=!0,g||(W=[M(t,"mousemove",F),M(t,"click",Z)],g=!0)},p(p,f){e=p,z?z.p&&(!n||f[0]&2101249)&&J(z,A,e,e[21],n?I(A,e[21],f,Ce):H(e[21]),te):m&&m.p&&(!n||f[0]&4609)&&m.p(e,n?f:[-1,-1]),(!n||f[0]&5121&&o!==(o=e[30]))&&u(t,"x",o),(!n||f[0]&5121&&a!==(a=e[31]))&&u(t,"y",a),(!n||f[0]&64)&&u(t,"dy",e[6]),(!n||f[0]&2064&&c!==(c=e[4]/e[11].k+"px"))&&u(t,"stroke-width",c),(!n||f[0]&8)&&u(t,"stroke",e[3]),(!n||f[0]&32)&&u(t,"text-anchor",e[5]),f[0]&2052&&h!==(h=`${e[2]/e[11].k}px`)&&E(t,"font-size",h),C?C.p&&(!n||f[0]&2101249)&&J(C,L,e,e[21],n?I(L,e[21],f,ze):H(e[21]),ee):y&&y.p&&(!n||f[0]&4609)&&y.p(e,n?f:[-1,-1]),(!n||f[0]&5121&&_!==(_=e[30]))&&u(s,"x",_),(!n||f[0]&5121&&r!==(r=e[31]))&&u(s,"y",r),(!n||f[0]&64)&&u(s,"dy",e[6]),(!n||f[0]&2)&&u(s,"fill",e[1]),(!n||f[0]&32)&&u(s,"text-anchor",e[5]),f[0]&2052&&d!==(d=`${e[2]/e[11].k}px`)&&E(s,"font-size",d)},i(p){n||(w(m,p),w(y,p),n=!0)},o(p){V(m,p),V(y,p),n=!1},d(p){p&&k(i),m&&m.d(p),y&&y.d(p),g=!1,se(W)}}}function Le(e){let i,t,o=(!e[7]||e[11].k>=e[7])&&ie(e);return{c(){o&&o.c(),i=K()},l(a){o&&o.l(a),i=K()},m(a,c){o&&o.m(a,c),j(a,i,c),t=!0},p(a,c){!a[7]||a[11].k>=a[7]?o?(o.p(a,c),c[0]&2176&&w(o,1)):(o=ie(a),o.c(),w(o,1),o.m(i.parentNode,i)):o&&(le(),V(o,1,1,()=>{o=null}),ne())},i(a){t||(w(o),t=!0)},o(a){V(o),t=!1},d(a){a&&k(i),o&&o.d(a)}}}function Ee(e,i,t){let o,a,c,h,{$$slots:s={},$$scope:_}=i;const{projection:r,features:d,transform:n,handleLayerClick:g,handleLayerMousemove:W}=ke("map");O(e,r,l=>t(20,a=l)),O(e,d,l=>t(12,h=l)),O(e,n,l=>t(11,c=l));let{features:A=void 0}=i,{fontColor:z=U.white}=i,{fontSize:m=12}=i,{stroke:F=U.black}=i,{strokeWidth:Z=3}=i,{textAnchor:L="middle"}=i,{dy:C="-.5em"}=i,{minZoom:y=0}=i,{pointerEvents:p=!0}=i,{getLabel:f=l=>l}=i,{tooltip:S=!1}=i;const v=ge();function q(l,b){X(l.target),S&&W(Y(l,b)),v("mousemove",{e:l,props:b.properties})}function D(l,b){X(l.target),S&&g(Y(l,b)),v("click",{e:l,props:b.properties})}const ue=(l,b)=>q(b,l),de=(l,b)=>D(b,l),pe=l=>v("mouseout"),ce=l=>v("mouseout");return e.$$set=l=>{"features"in l&&t(0,A=l.features),"fontColor"in l&&t(1,z=l.fontColor),"fontSize"in l&&t(2,m=l.fontSize),"stroke"in l&&t(3,F=l.stroke),"strokeWidth"in l&&t(4,Z=l.strokeWidth),"textAnchor"in l&&t(5,L=l.textAnchor),"dy"in l&&t(6,C=l.dy),"minZoom"in l&&t(7,y=l.minZoom),"pointerEvents"in l&&t(8,p=l.pointerEvents),"getLabel"in l&&t(9,f=l.getLabel),"tooltip"in l&&t(19,S=l.tooltip),"$$scope"in l&&t(21,_=l.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1048576&&t(10,o=we(a))},[A,z,m,F,Z,L,C,y,p,f,o,c,h,r,d,n,v,q,D,S,a,_,s,ue,de,pe,ce]}class Ve extends ye{constructor(i){super(),he(this,i,Ee,Le,_e,{features:0,fontColor:1,fontSize:2,stroke:3,strokeWidth:4,textAnchor:5,dy:6,minZoom:7,pointerEvents:8,getLabel:9,tooltip:19},null,[-1,-1])}}Ve.__docgen={version:3,name:"SVGLabelLayer.svelte",data:[{visibility:"public",description:"A list of GeoJSON features. By default this component will render the features set in the parent SVGMap, but if `features` is defined, it plots those instead. Features are rendered as SVG `text` elements. Polygon features are converted to points with `d3.geoPath().centroid`.",keywords:[{name:"type",description:"{Array} [features]"}],name:"features",kind:"const",static:!1,readonly:!0,type:{kind:"type",text:"Array",type:"Array"}},{keywords:[{name:"type",description:"{ string } [fontColor=urbanColors.white]"}],visibility:"public",description:"Color of the text label",name:"fontColor",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"string",type:"string"}},{keywords:[{name:"type",description:"{ number } [fontSize=12]"}],visibility:"public",description:"Font size of the text label",name:"fontSize",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"number",type:"number"},defaultValue:12},{keywords:[{name:"type",description:"{ string } [stroke=urbanColors.black]"}],visibility:"public",description:"Color of the text label outline",name:"stroke",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"string",type:"string"}},{keywords:[{name:"type",description:"{ number } [strokeWidth=3]"}],visibility:"public",description:"Width of the outline of the text label",name:"strokeWidth",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"number",type:"number"},defaultValue:3},{keywords:[{name:"type",description:'{ string } [textAnchor="middle"]'}],visibility:"public",description:"Text anchor property of the label",name:"textAnchor",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"string",type:"string"},defaultValue:"middle"},{keywords:[{name:"type",description:'{ string } [dy="-.5em"]'}],visibility:"public",description:"`dy` property of the label",name:"dy",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"string",type:"string"},defaultValue:"-.5em"},{keywords:[{name:"type",description:"{ number } [minZoom = 0]"}],visibility:"public",description:"Minumum zoom factor at which to render layer relative to the default zoom",name:"minZoom",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"number",type:"number"},defaultValue:0},{keywords:[{name:"type",description:"{boolean} [pointerEvents]"}],visibility:"public",description:"Boolean that determines if this layer should respond to pointer events and dispatch events.",name:"pointerEvents",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"boolean",type:"boolean"},defaultValue:!0},{keywords:[{name:"param",description:"{ Object } d the feature on which the label will be based"},{name:"returns",description:"{ string }"}],visibility:"public",description:"Function that returns the string to be displayed in the label when passed a feature object",name:"getLabel",kind:"let",static:!1,readonly:!1,type:{kind:"function",text:"function",type:"function",params:[{name:"d",type:{kind:"type",text:"Object",type:"Object"},description:"the feature on which the label will be based",optional:!1}],return:{type:{kind:"type",text:"string",type:"string"},description:null}}},{keywords:[{name:"type",description:"{boolean} [tooltip = false]"}],visibility:"public",description:"Boolean that determines if this layer should populate the tooltip slot when interacted with.",name:"tooltip",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"boolean",type:"boolean"},defaultValue:!1}],computed:[],methods:[],components:[],description:null,keywords:[],events:[{visibility:"public",description:null,keywords:[],name:"mousemove"},{visibility:"public",description:null,keywords:[],name:"click"},{visibility:"public",description:null,keywords:[],name:"mouseout"}],slots:[{keywords:[],visibility:"public",description:"Default slot overrides output of `getLabel` prop",name:"default",params:[{name:"props",type:{kind:"type",text:"*",type:"any"}}],parameters:[{name:"props",type:{kind:"type",text:"*",type:"any"}}]}],refs:[]};export{Ve as S};
