var M=h=>{throw TypeError(h)};var S=(h,s,r)=>s.has(h)||M("Cannot "+r);var I=(h,s,r)=>(S(h,s,"read from private field"),r?r.call(h):s.get(h)),P=(h,s,r)=>s.has(h)?M("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(h):s.set(h,r);import{ax as N,bh as W,T as B,i as z,Z as L,a7 as O,bi as U,p as F,g as D,z as V,Q as H,a as T,y as Y,b as A,d as j,a5 as q}from"./iframe-BjxEKEQH.js";var C={exports:{}};/*! pym.js - v1.3.2 - 2018-02-13 */var R;function G(){return R||(R=1,function(h){(function(s){h.exports?h.exports=s():window.pym=s.call(this)})(function(){var s="xPYMx",r={},f=function(n){var a=document.createEvent("Event");a.initEvent("pym:"+n,!0,!0),document.dispatchEvent(a)},m=function(n){var a=new RegExp("[\\?&]"+n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)"),o=a.exec(location.search);return o===null?"":decodeURIComponent(o[1].replace(/\+/g," "))},b=function(n,a){if(!(a.xdomain!=="*"&&!n.origin.match(new RegExp(a.xdomain+"$")))&&typeof n.data=="string")return!0},_=function(n){var a=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/gi;if(n.match(a))return!0},u=function(n,a,o){var d=["pym",n,a,o];return d.join(s)},c=function(n){var a=["pym",n,"(\\S+)","(.*)"];return new RegExp("^"+a.join(s)+"$")},y=Date.now||function(){return new Date().getTime()},k=function(n,a,o){var d,t,e,i=null,l=0;o||(o={});var g=function(){l=o.leading===!1?0:y(),i=null,e=n.apply(d,t),i||(d=t=null)};return function(){var p=y();!l&&o.leading===!1&&(l=p);var v=a-(p-l);return d=this,t=arguments,v<=0||v>a?(i&&(clearTimeout(i),i=null),l=p,e=n.apply(d,t),i||(d=t=null)):!i&&o.trailing!==!1&&(i=setTimeout(g,v)),e}},E=function(){for(var n=r.autoInitInstances.length,a=n-1;a>=0;a--){var o=r.autoInitInstances[a];o.el.getElementsByTagName("iframe").length&&o.el.getElementsByTagName("iframe")[0].contentWindow||r.autoInitInstances.splice(a,1)}};return r.autoInitInstances=[],r.autoInit=function(n){var a=document.querySelectorAll("[data-pym-src]:not([data-pym-auto-initialized])"),o=a.length;E();for(var d=0;d<o;++d){var t=a[d];t.setAttribute("data-pym-auto-initialized",""),t.id===""&&(t.id="pym-"+d+"-"+Math.random().toString(36).substr(2,5));var e=t.getAttribute("data-pym-src"),i={xdomain:"string",title:"string",name:"string",id:"string",sandbox:"string",allowfullscreen:"boolean",parenturlparam:"string",parenturlvalue:"string",optionalparams:"boolean",trackscroll:"boolean",scrollwait:"number"},l={};for(var g in i)if(t.getAttribute("data-pym-"+g)!==null)switch(i[g]){case"boolean":l[g]=t.getAttribute("data-pym-"+g)!=="false";break;case"string":l[g]=t.getAttribute("data-pym-"+g);break;case"number":var p=Number(t.getAttribute("data-pym-"+g));isNaN(p)||(l[g]=p);break;default:console.err("unrecognized attribute type")}var v=new r.Parent(t.id,e,l);r.autoInitInstances.push(v)}return n||f("pym-initialized"),r.autoInitInstances},r.Parent=function(n,a,o){this.id=n,this.url=a,this.el=document.getElementById(n),this.iframe=null,this.settings={xdomain:"*",optionalparams:!0,parenturlparam:"parentUrl",parenturlvalue:window.location.href,trackscroll:!1,scrollwait:100},this.messageRegex=c(this.id),this.messageHandlers={},o=o||{},this._constructIframe=function(){var t=this.el.offsetWidth.toString();this.iframe=document.createElement("iframe");var e="",i=this.url.indexOf("#");for(i>-1&&(e=this.url.substring(i,this.url.length),this.url=this.url.substring(0,i)),this.url.indexOf("?")<0?this.url+="?":this.url+="&",this.iframe.src=this.url+"initialWidth="+t+"&childId="+this.id,this.settings.optionalparams&&(this.iframe.src+="&parentTitle="+encodeURIComponent(document.title),this.iframe.src+="&"+this.settings.parenturlparam+"="+encodeURIComponent(this.settings.parenturlvalue)),this.iframe.src+=e,this.iframe.setAttribute("width","100%"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("frameborder","0"),this.settings.title&&this.iframe.setAttribute("title",this.settings.title),this.settings.allowfullscreen!==void 0&&this.settings.allowfullscreen!==!1&&this.iframe.setAttribute("allowfullscreen",""),this.settings.sandbox!==void 0&&typeof this.settings.sandbox=="string"&&this.iframe.setAttribute("sandbox",this.settings.sandbox),this.settings.id&&(document.getElementById(this.settings.id)||this.iframe.setAttribute("id",this.settings.id)),this.settings.name&&this.iframe.setAttribute("name",this.settings.name);this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.appendChild(this.iframe),window.addEventListener("resize",this._onResize),this.settings.trackscroll&&window.addEventListener("scroll",this._throttleOnScroll)},this._onResize=(function(){this.sendWidth(),this.settings.trackscroll&&this.sendViewportAndIFramePosition()}).bind(this),this._onScroll=(function(){this.sendViewportAndIFramePosition()}).bind(this),this._fire=function(t,e){if(t in this.messageHandlers)for(var i=0;i<this.messageHandlers[t].length;i++)this.messageHandlers[t][i].call(this,e)},this.remove=function(){window.removeEventListener("message",this._processMessage),window.removeEventListener("resize",this._onResize),this.el.removeChild(this.iframe),E()},this._processMessage=(function(t){if(b(t,this.settings)&&typeof t.data=="string"){var e=t.data.match(this.messageRegex);if(!e||e.length!==3)return!1;var i=e[1],l=e[2];this._fire(i,l)}}).bind(this),this._onHeightMessage=function(t){var e=parseInt(t);this.iframe.setAttribute("height",e+"px")},this._onNavigateToMessage=function(t){_(t)&&(document.location.href=t)},this._onScrollToChildPosMessage=function(t){var e=document.getElementById(this.id).getBoundingClientRect().top+window.pageYOffset,i=e+parseInt(t);window.scrollTo(0,i)},this.onMessage=function(t,e){t in this.messageHandlers||(this.messageHandlers[t]=[]),this.messageHandlers[t].push(e)},this.sendMessage=function(t,e){this.el.getElementsByTagName("iframe").length&&(this.el.getElementsByTagName("iframe")[0].contentWindow?this.el.getElementsByTagName("iframe")[0].contentWindow.postMessage(u(this.id,t,e),"*"):this.remove())},this.sendWidth=function(){var t=this.el.offsetWidth.toString();this.sendMessage("width",t)},this.sendViewportAndIFramePosition=function(){var t=this.iframe.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,l=e+" "+i;l+=" "+t.top+" "+t.left,l+=" "+t.bottom+" "+t.right,this.sendMessage("viewport-iframe-position",l)};for(var d in o)this.settings[d]=o[d];return this._throttleOnScroll=k(this._onScroll.bind(this),this.settings.scrollwait),this.onMessage("height",this._onHeightMessage),this.onMessage("navigateTo",this._onNavigateToMessage),this.onMessage("scrollToChildPos",this._onScrollToChildPosMessage),this.onMessage("parentPositionInfo",this.sendViewportAndIFramePosition),window.addEventListener("message",this._processMessage,!1),this._constructIframe(),this},r.Child=function(n){this.parentWidth=null,this.id=null,this.parentTitle=null,this.parentUrl=null,this.settings={renderCallback:null,xdomain:"*",polling:0,parenturlparam:"parentUrl"},this.timerId=null,this.messageRegex=null,this.messageHandlers={},n=n||{},this.onMessage=function(t,e){t in this.messageHandlers||(this.messageHandlers[t]=[]),this.messageHandlers[t].push(e)},this._fire=function(t,e){if(t in this.messageHandlers)for(var i=0;i<this.messageHandlers[t].length;i++)this.messageHandlers[t][i].call(this,e)},this._processMessage=(function(t){if(b(t,this.settings)&&typeof t.data=="string"){var e=t.data.match(this.messageRegex);if(!(!e||e.length!==3)){var i=e[1],l=e[2];this._fire(i,l)}}}).bind(this),this._onWidthMessage=function(t){var e=parseInt(t);e!==this.parentWidth&&(this.parentWidth=e,this.settings.renderCallback&&this.settings.renderCallback(e),this.sendHeight())},this.sendMessage=function(t,e){window.parent.postMessage(u(this.id,t,e),"*")},this.sendHeight=(function(){var t=document.getElementsByTagName("body")[0].offsetHeight.toString();return this.sendMessage("height",t),t}).bind(this),this.getParentPositionInfo=function(){this.sendMessage("parentPositionInfo")},this.scrollParentTo=function(t){this.sendMessage("navigateTo","#"+t)},this.navigateParentTo=function(t){this.sendMessage("navigateTo",t)},this.scrollParentToChildEl=function(t){var e=document.getElementById(t).getBoundingClientRect().top+window.pageYOffset;this.scrollParentToChildPos(e)},this.scrollParentToChildPos=function(t){this.sendMessage("scrollToChildPos",t.toString())};var a=function(t){var e=document.getElementsByTagName("html")[0],i,l=e.className;try{window.self!==window.top?i="embedded":i="not-embedded"}catch{i="embedded"}l.indexOf(i)<0&&(e.className=l?l+" "+i:i,t&&t(i),f("marked-embedded"))};this.remove=function(){window.removeEventListener("message",this._processMessage),this.timerId&&clearInterval(this.timerId)};for(var o in n)this.settings[o]=n[o];this.id=m("childId")||n.id,this.messageRegex=new RegExp("^pym"+s+this.id+s+"(\\S+)"+s+"(.*)$");var d=parseInt(m("initialWidth"));return this.parentUrl=m(this.settings.parenturlparam),this.parentTitle=m("parentTitle"),this.onMessage("width",this._onWidthMessage),window.addEventListener("message",this._processMessage,!1),this.settings.renderCallback&&this.settings.renderCallback(d),this.sendHeight(),this.settings.polling&&(this.timerId=window.setInterval(this.sendHeight,this.settings.polling)),a(n.onMarkedEmbeddedStatus),this},typeof document<"u"&&r.autoInit(!0),r})}(C)),C.exports}var K=G();const Q=N(K),x=Symbol("pym-child-context");var w;class X{constructor(){P(this,w,B(null))}get child(){return z(I(this,w))}set child(s){L(I(this,w),s,!0)}setChild(s){this.child=s}clear(){this.child=null}sendHeight(...s){var r,f;(f=(r=this.child)==null?void 0:r.sendHeight)==null||f.call(r,...s)}}w=new WeakMap;function Z(){const h=new X;return W(x,h),h}function et(){return U(x)?O(x):void 0}function J(h,s){F(s,!0);let r=D(s,"polling",3,500);const f=Z();V(()=>{if(typeof window>"u")return;const u=new Q.Child({polling:r()});return f.setChild(u),()=>{var c;(c=u==null?void 0:u.remove)==null||c.call(u),f.clear()}});var m=H(),b=T(m);{var _=u=>{var c=H(),y=T(c);q(y,()=>s.children),A(u,c)};Y(b,u=>{s.children&&u(_)})}A(h,m),j()}J.__docgen={data:[{name:"polling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"500"},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1}],name:"PymChild.svelte"};export{J as P,et as u};
