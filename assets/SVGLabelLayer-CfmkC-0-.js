import{K as te,bo as he,bp as ke,bq as _e,br as ge,P as xe,x as we,bs as Ce,W as Ee,bt as Fe,R as Se,_ as W,bu as ae,bv as ie,bw as Ve,p as Le,am as ze,o as m,ai as Ae,C as Te,D as Pe,ag as je,a as Ge,G as We,b as M,d as Me,n as Ne,l as I,E as Oe,F as qe,q as ce,c as K,ah as se,Z as re,t as q,h as J,g as y,e as oe,s as Be,a2 as B}from"./iframe-BcferWuU.js";import{e as Re,i as Ze}from"./each-CZjc6dyk.js";import{s as v}from"./attributes-1snxx-6i.js";import{s as U}from"./style-CNURdi_Z.js";import{i as De}from"./lifecycle-BcSUtK95.js";import{u as ne}from"./urbanColors-BkxYcPwH.js";import{g as Ie,r as le,d as fe}from"./lib-Bn4Zx1sO.js";const Ke=()=>performance.now(),_={tick:t=>requestAnimationFrame(t),now:()=>Ke(),tasks:new Set};function ue(){const t=_.now();_.tasks.forEach(e=>{e.c(t)||(_.tasks.delete(e),e.f())}),_.tasks.size!==0&&_.tick(ue)}function Je(t){let e;return _.tasks.size===0&&_.tick(ue),{promise:new Promise(a=>{_.tasks.add(e={c:t,f:a})}),abort(){_.tasks.delete(e)}}}function R(t,e){Ee(()=>{t.dispatchEvent(new CustomEvent(e))})}function Ue(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function de(t){const e={},a=t.split(";");for(const s of a){const[n,l]=s.split(":");if(!n||l===void 0)break;const f=Ue(n.trim());e[f]=l.trim()}return e}const He=t=>t;function Qe(t,e,a,s){var n=(t&Ce)!==0,l="both",f,g=e.inert,T=e.style.overflow,o,r;function x(){var d=Ve,C=te;ae(null),ie(null);try{return f??(f=a()(e,(s==null?void 0:s())??{},{direction:l}))}finally{ae(d),ie(C)}}var w={is_global:n,in(){e.inert=g,R(e,"introstart"),o=H(e,x(),r,1,()=>{R(e,"introend"),o==null||o.abort(),o=f=void 0,e.style.overflow=T})},out(d){e.inert=!0,R(e,"outrostart"),r=H(e,x(),o,0,()=>{R(e,"outroend"),d==null||d()})},stop:()=>{o==null||o.abort(),r==null||r.abort()}},h=te;if((h.transitions??(h.transitions=[])).push(w),he){var b=n;if(!b){for(var i=h.parent;i&&(i.f&ke)!==0;)for(;(i=i.parent)&&(i.f&_e)===0;);b=!i||(i.f&ge)!==0}b&&xe(()=>{we(()=>w.in())})}}function H(t,e,a,s,n){var l=s===1;if(Fe(e)){var f,g=!1;return Se(()=>{if(!g){var d=e({direction:l?"in":"out"});f=H(t,d,a,s,n)}}),{abort:()=>{g=!0,f==null||f.abort()},deactivate:()=>f.deactivate(),reset:()=>f.reset(),t:()=>f.t()}}if(a==null||a.deactivate(),!(e!=null&&e.duration))return n(),{abort:W,deactivate:W,reset:W,t:()=>s};const{delay:T=0,css:o,tick:r,easing:x=He}=e;var w=[];if(l&&a===void 0&&(r&&r(0,1),o)){var h=de(o(0,1));w.push(h,h)}var b=()=>1-s,i=t.animate(w,{duration:T,fill:"forwards"});return i.onfinish=()=>{i.cancel();var d=(a==null?void 0:a.t())??1-s;a==null||a.abort();var C=s-d,E=e.duration*Math.abs(C),P=[];if(E>0){var j=!1;if(o)for(var N=Math.ceil(E/16.666666666666668),z=0;z<=N;z+=1){var G=d+C*x(z/N),F=de(o(G,1-G));P.push(F),j||(j=F.overflow==="hidden")}j&&(t.style.overflow="hidden"),b=()=>{var A=i.currentTime;return d+C*x(A/E)},r&&Je(()=>{if(i.playState!=="running")return!1;var A=b();return r(A,1-A),!0})}i=t.animate(P,{duration:E,fill:"forwards"}),i.onfinish=()=>{b=()=>s,r==null||r(s,1-s),n()}},{abort:()=>{i&&(i.cancel(),i.effect=null,i.onfinish=W)},deactivate:()=>{n=W},reset:()=>{s===0&&(r==null||r(1,0))},t:()=>b()}}const Xe=t=>t;function Ye(t,{delay:e=0,duration:a=400,easing:s=Xe}={}){const n=+getComputedStyle(t).opacity;return{delay:e,duration:a,easing:s,css:l=>`opacity: ${l*n}`}}var $e=ce('<g class="label-feature"><text stroke-linejoin="round"><!></text><text><!></text></g>'),et=ce('<g class="map-layer label-layer"></g>');function tt(t,e){Le(e,!1);const[a,s]=Ne(),n=()=>I(T,"$projection",a),l=()=>I(r,"$transform",a),f=()=>I(o,"$globalFeatures",a),g=qe(),{projection:T,features:o,transform:r,handleLayerClick:x,handleLayerMousemove:w}=ze("map");let h=m(e,"features",8,void 0),b=m(e,"fontColor",24,()=>ne.white),i=m(e,"fontSize",8,12),d=m(e,"stroke",24,()=>ne.black),C=m(e,"strokeWidth",8,3),E=m(e,"textAnchor",8,"middle"),P=m(e,"dy",8,"-.5em"),j=m(e,"minZoom",8,0),N=m(e,"pointerEvents",8,!0),z=m(e,"getLabel",8,c=>c),G=m(e,"tooltip",8,!1);const F=Ae();function A(c,u){le(c.target),G()&&w(fe(c,u)),F("mousemove",{e:c,props:u.properties})}function pe(c,u){le(c.target),G()&&x(fe(c,u)),F("click",{e:c,props:u.properties})}Te(()=>n(),()=>{Oe(g,Ie(n()))}),Pe(),De();var Q=je(),ye=Ge(Q);{var ve=c=>{var u=et();let X;Re(u,5,()=>h()||f(),Ze,(Z,S)=>{var Y=$e();const O=J(()=>{const[k,L]=y(g).centroid(y(S));return{x:k,y:L}});var p=K(Y);v(p,"opacity",.5);let $;var me=K(p);se(me,e,"default",{get props(){return y(S).properties}},k=>{var L=re();q(D=>oe(L,D),[()=>z()(y(S))],J),M(k,L)});var V=Be(p);let ee;var be=K(V);se(be,e,"default",{get props(){return y(S).properties}},k=>{var L=re();q(D=>oe(L,D),[()=>z()(y(S))],J),M(k,L)}),q(()=>{v(p,"x",y(O).x),v(p,"y",y(O).y),v(p,"dy",P()),v(p,"stroke-width",`${C()/l().k}px`),v(p,"stroke",d()),v(p,"text-anchor",E()),$=U(p,"",$,{"font-size":`${i()/l().k}px`}),v(V,"x",y(O).x),v(V,"y",y(O).y),v(V,"dy",P()),v(V,"fill",b()),v(V,"text-anchor",E()),ee=U(V,"",ee,{"font-size":`${i()/l().k}px`})}),B("mousemove",p,k=>A(k,y(S))),B("click",p,k=>pe(k,y(S))),M(Z,Y)}),q(()=>X=U(u,"",X,{"pointer-events":N()?"auto":"none"})),B("mouseout",u,Z=>F("mouseout")),B("blur",u,Z=>F("mouseout")),Qe(3,u,()=>Ye,()=>({duration:250})),M(c,u)};We(ye,c=>{(!j()||l().k>=j())&&c(ve)})}M(t,Q),Me(),s()}tt.__docgen={data:[{name:"features",visibility:"public",description:"A list of GeoJSON features. By default this component will render the features set in the parent SVGMap, but if `features` is defined, it plots those instead. Features are rendered as SVG `text` elements. Polygon features are converted to points with `d3.geoPath().centroid`.\n[features]",keywords:[],kind:"let",type:{kind:"type",type:"array",text:"any[]"},static:!1,readonly:!1},{name:"fontColor",visibility:"public",description:`Color of the text label
[fontColor=urbanColors.white]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"fontSize",visibility:"public",description:`Font size of the text label
[fontSize=12]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"12"},{name:"stroke",visibility:"public",description:`Color of the text label outline
[stroke=urbanColors.black]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"strokeWidth",visibility:"public",description:`Width of the outline of the text label
[strokeWidth=3]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"3"},{name:"textAnchor",visibility:"public",description:`Text anchor property of the label
[textAnchor="middle"]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"middle"'},{name:"dy",visibility:"public",description:'`dy` property of the label\n[dy="-.5em"]',keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"-.5em"'},{name:"minZoom",visibility:"public",description:`Minumum zoom factor at which to render layer relative to the default zoom
[minZoom = 0]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"0"},{name:"pointerEvents",visibility:"public",description:`Boolean that determines if this layer should respond to pointer events and dispatch events.
[pointerEvents]`,keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"true"},{name:"getLabel",visibility:"public",description:"Function that returns the string to be displayed in the label when passed a feature object",keywords:[],kind:"let",type:{kind:"function",text:"(d: Object) => string"},static:!1,readonly:!1,defaultValue:"function"},{name:"tooltip",visibility:"public",description:`Boolean that determines if this layer should populate the tooltip slot when interacted with.
[tooltip = false]`,keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"}],name:"SVGLabelLayer.svelte"};export{tt as S};
