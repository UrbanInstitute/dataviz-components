import{E as te,bp as he,bq as ke,br as _e,bs as xe,J as ge,n as we,bt as Ce,P as Ee,bu as Fe,L as Se,U as M,bv as ae,bw as ie,bx as Ve,p as Le,aa as ze,i as b,a7 as Ae,w as Te,x as Pe,a6 as je,a as Ge,A as Me,b as N,d as Ne,ab as Oe,ac as J,y as We,z as Be,k as ce,c as U,a5 as se,T as re,t as B,h as D,g as y,e as oe,s as qe,X as q}from"./iframe-DyWuGZgA.js";import{e as Re,i as Ze}from"./each-BdKYQQNe.js";import{s as v}from"./attributes-DesoiSbl.js";import{s as K}from"./style-CNURdi_Z.js";import{i as Ie}from"./lifecycle-BV4teSqg.js";import{u as ne}from"./urbanColors-BkxYcPwH.js";import{g as Je,r as le,d as fe}from"./lib-ByG-hXMu.js";const Ue=()=>performance.now(),_={tick:t=>requestAnimationFrame(t),now:()=>Ue(),tasks:new Set};function ue(){const t=_.now();_.tasks.forEach(e=>{e.c(t)||(_.tasks.delete(e),e.f())}),_.tasks.size!==0&&_.tick(ue)}function De(t){let e;return _.tasks.size===0&&_.tick(ue),{promise:new Promise(a=>{_.tasks.add(e={c:t,f:a})}),abort(){_.tasks.delete(e)}}}function R(t,e){Ee(()=>{t.dispatchEvent(new CustomEvent(e))})}function Ke(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function de(t){const e={},a=t.split(";");for(const s of a){const[n,l]=s.split(":");if(!n||l===void 0)break;const f=Ke(n.trim());e[f]=l.trim()}return e}const Xe=t=>t;function He(t,e,a,s){var n=(t&Ce)!==0,l="both",f,x=e.inert,T=e.style.overflow,o,r;function g(){var d=Ve,C=te;ae(null),ie(null);try{return f??(f=a()(e,(s==null?void 0:s())??{},{direction:l}))}finally{ae(d),ie(C)}}var w={is_global:n,in(){e.inert=x,R(e,"introstart"),o=X(e,g(),r,1,()=>{R(e,"introend"),o==null||o.abort(),o=f=void 0,e.style.overflow=T})},out(d){e.inert=!0,R(e,"outrostart"),r=X(e,g(),o,0,()=>{R(e,"outroend"),d==null||d()})},stop:()=>{o==null||o.abort(),r==null||r.abort()}},h=te;if((h.transitions??(h.transitions=[])).push(w),he){var m=n;if(!m){for(var i=h.parent;i&&(i.f&ke)!==0;)for(;(i=i.parent)&&(i.f&_e)===0;);m=!i||(i.f&xe)!==0}m&&ge(()=>{we(()=>w.in())})}}function X(t,e,a,s,n){var l=s===1;if(Fe(e)){var f,x=!1;return Se(()=>{if(!x){var d=e({direction:l?"in":"out"});f=X(t,d,a,s,n)}}),{abort:()=>{x=!0,f==null||f.abort()},deactivate:()=>f.deactivate(),reset:()=>f.reset(),t:()=>f.t()}}if(a==null||a.deactivate(),!(e!=null&&e.duration))return n(),{abort:M,deactivate:M,reset:M,t:()=>s};const{delay:T=0,css:o,tick:r,easing:g=Xe}=e;var w=[];if(l&&a===void 0&&(r&&r(0,1),o)){var h=de(o(0,1));w.push(h,h)}var m=()=>1-s,i=t.animate(w,{duration:T,fill:"forwards"});return i.onfinish=()=>{i.cancel();var d=(a==null?void 0:a.t())??1-s;a==null||a.abort();var C=s-d,E=e.duration*Math.abs(C),P=[];if(E>0){var j=!1;if(o)for(var O=Math.ceil(E/16.666666666666668),z=0;z<=O;z+=1){var G=d+C*g(z/O),F=de(o(G,1-G));P.push(F),j||(j=F.overflow==="hidden")}j&&(t.style.overflow="hidden"),m=()=>{var A=i.currentTime;return d+C*g(A/E)},r&&De(()=>{if(i.playState!=="running")return!1;var A=m();return r(A,1-A),!0})}i=t.animate(P,{duration:E,fill:"forwards"}),i.onfinish=()=>{m=()=>s,r==null||r(s,1-s),n()}},{abort:()=>{i&&(i.cancel(),i.effect=null,i.onfinish=M)},deactivate:()=>{n=M},reset:()=>{s===0&&(r==null||r(1,0))},t:()=>m()}}const Qe=t=>t;function Ye(t,{delay:e=0,duration:a=400,easing:s=Qe}={}){const n=+getComputedStyle(t).opacity;return{delay:e,duration:a,easing:s,css:l=>`opacity: ${l*n}`}}var $e=ce('<g class="label-feature"><text stroke-linejoin="round"><!></text><text><!></text></g>'),et=ce('<g class="map-layer label-layer"></g>');function tt(t,e){Le(e,!1);const[a,s]=Oe(),n=()=>J(T,"$projection",a),l=()=>J(r,"$transform",a),f=()=>J(o,"$globalFeatures",a),x=Be(),{projection:T,features:o,transform:r,handleLayerClick:g,handleLayerMousemove:w}=ze("map");let h=b(e,"features",8,void 0),m=b(e,"fontColor",24,()=>ne.white),i=b(e,"fontSize",8,12),d=b(e,"stroke",24,()=>ne.black),C=b(e,"strokeWidth",8,3),E=b(e,"textAnchor",8,"middle"),P=b(e,"dy",8,"-.5em"),j=b(e,"minZoom",8,0),O=b(e,"pointerEvents",8,!0),z=b(e,"getLabel",8,c=>c),G=b(e,"tooltip",8,!1);const F=Ae();function A(c,u){le(c.target),G()&&w(fe(c,u)),F("mousemove",{e:c,props:u.properties})}function pe(c,u){le(c.target),G()&&g(fe(c,u)),F("click",{e:c,props:u.properties})}Te(()=>n(),()=>{We(x,Je(n()))}),Pe(),Ie();var H=je(),ye=Ge(H);{var ve=c=>{var u=et();let Q;Re(u,5,()=>h()||f(),Ze,(Z,S)=>{var Y=$e();const W=D(()=>{const[k,L]=y(x).centroid(y(S));return{x:k,y:L}});var p=U(Y);v(p,"opacity",.5);let $;var be=U(p);se(be,e,"default",{get props(){return y(S).properties}},k=>{var L=re();B(I=>oe(L,I),[()=>z()(y(S))],D),N(k,L)});var V=qe(p);let ee;var me=U(V);se(me,e,"default",{get props(){return y(S).properties}},k=>{var L=re();B(I=>oe(L,I),[()=>z()(y(S))],D),N(k,L)}),B(()=>{v(p,"x",y(W).x),v(p,"y",y(W).y),v(p,"dy",P()),v(p,"stroke-width",`${C()/l().k}px`),v(p,"stroke",d()),v(p,"text-anchor",E()),$=K(p,"",$,{"font-size":`${i()/l().k}px`}),v(V,"x",y(W).x),v(V,"y",y(W).y),v(V,"dy",P()),v(V,"fill",m()),v(V,"text-anchor",E()),ee=K(V,"",ee,{"font-size":`${i()/l().k}px`})}),q("mousemove",p,k=>A(k,y(S))),q("click",p,k=>pe(k,y(S))),N(Z,Y)}),B(()=>Q=K(u,"",Q,{"pointer-events":O()?"auto":"none"})),q("mouseout",u,Z=>F("mouseout")),q("blur",u,Z=>F("mouseout")),He(3,u,()=>Ye,()=>({duration:250})),N(c,u)};Me(ye,c=>{(!j()||l().k>=j())&&c(ve)})}N(t,H),Ne(),s()}tt.__docgen={data:[{name:"features",visibility:"public",description:"A list of GeoJSON features. By default this component will render the features set in the parent SVGMap, but if `features` is defined, it plots those instead. Features are rendered as SVG `text` elements. Polygon features are converted to points with `d3.geoPath().centroid`.\n[features]",keywords:[],kind:"let",type:{kind:"type",type:"array",text:"any[]"},static:!1,readonly:!1},{name:"fontColor",visibility:"public",description:`Color of the text label
[fontColor=urbanColors.white]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"fontSize",visibility:"public",description:`Font size of the text label
[fontSize=12]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"12"},{name:"stroke",visibility:"public",description:`Color of the text label outline
[stroke=urbanColors.black]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"strokeWidth",visibility:"public",description:`Width of the outline of the text label
[strokeWidth=3]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"3"},{name:"textAnchor",visibility:"public",description:`Text anchor property of the label
[textAnchor="middle"]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"middle"'},{name:"dy",visibility:"public",description:'`dy` property of the label\n[dy="-.5em"]',keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"-.5em"'},{name:"minZoom",visibility:"public",description:`Minumum zoom factor at which to render layer relative to the default zoom
[minZoom = 0]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"0"},{name:"pointerEvents",visibility:"public",description:`Boolean that determines if this layer should respond to pointer events and dispatch events.
[pointerEvents]`,keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"true"},{name:"getLabel",visibility:"public",description:"Function that returns the string to be displayed in the label when passed a feature object",keywords:[],kind:"let",type:{kind:"function",text:"(d: Object) => string"},static:!1,readonly:!1,defaultValue:"function"},{name:"tooltip",visibility:"public",description:`Boolean that determines if this layer should populate the tooltip slot when interacted with.
[tooltip = false]`,keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"}],name:"SVGLabelLayer.svelte"};export{tt as S};
