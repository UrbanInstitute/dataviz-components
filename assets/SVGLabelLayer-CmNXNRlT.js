import{F as te,bp as he,bq as ke,br as _e,bs as xe,K as ge,n as we,bt as Ce,Q as Fe,bu as Ee,M as Se,V as B,bv as ae,bw as ie,bx as Ve,p as ze,aa as Le,i as b,a8 as Ae,w as Te,x as je,a7 as Me,a as Pe,B as Be,b as G,d as Ge,ab as Ne,ac as K,y as Oe,z as We,k as ce,c as U,a6 as se,U as re,t as W,h as D,g as y,e as oe,s as qe,Y as q}from"./iframe-D_iF5c85.js";import{e as Re,i as Ze}from"./each-B1oKFb8M.js";import{s as v}from"./attributes-BlXGg7Yy.js";import{s as J}from"./style-CNURdi_Z.js";import{i as Ie}from"./lifecycle-DPT9lhMs.js";import{u as ne}from"./urbanColors-BkxYcPwH.js";import{g as Ke,r as le,d as fe}from"./lib-SbtGGwAb.js";const Ue=()=>performance.now(),_={tick:t=>requestAnimationFrame(t),now:()=>Ue(),tasks:new Set};function ue(){const t=_.now();_.tasks.forEach(e=>{e.c(t)||(_.tasks.delete(e),e.f())}),_.tasks.size!==0&&_.tick(ue)}function De(t){let e;return _.tasks.size===0&&_.tick(ue),{promise:new Promise(a=>{_.tasks.add(e={c:t,f:a})}),abort(){_.tasks.delete(e)}}}function R(t,e){Fe(()=>{t.dispatchEvent(new CustomEvent(e))})}function Je(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function de(t){const e={},a=t.split(";");for(const s of a){const[n,l]=s.split(":");if(!n||l===void 0)break;const f=Je(n.trim());e[f]=l.trim()}return e}const Qe=t=>t;function Ye(t,e,a,s){var n=(t&Ce)!==0,l="both",f,x=e.inert,T=e.style.overflow,o,r;function g(){var d=Ve,C=te;ae(null),ie(null);try{return f??(f=a()(e,(s==null?void 0:s())??{},{direction:l}))}finally{ae(d),ie(C)}}var w={is_global:n,in(){e.inert=x,R(e,"introstart"),o=Q(e,g(),r,1,()=>{R(e,"introend"),o==null||o.abort(),o=f=void 0,e.style.overflow=T})},out(d){e.inert=!0,R(e,"outrostart"),r=Q(e,g(),o,0,()=>{R(e,"outroend"),d==null||d()})},stop:()=>{o==null||o.abort(),r==null||r.abort()}},h=te;if((h.transitions??(h.transitions=[])).push(w),he){var m=n;if(!m){for(var i=h.parent;i&&(i.f&ke)!==0;)for(;(i=i.parent)&&(i.f&_e)===0;);m=!i||(i.f&xe)!==0}m&&ge(()=>{we(()=>w.in())})}}function Q(t,e,a,s,n){var l=s===1;if(Ee(e)){var f,x=!1;return Se(()=>{if(!x){var d=e({direction:l?"in":"out"});f=Q(t,d,a,s,n)}}),{abort:()=>{x=!0,f==null||f.abort()},deactivate:()=>f.deactivate(),reset:()=>f.reset(),t:()=>f.t()}}if(a==null||a.deactivate(),!(e!=null&&e.duration))return n(),{abort:B,deactivate:B,reset:B,t:()=>s};const{delay:T=0,css:o,tick:r,easing:g=Qe}=e;var w=[];if(l&&a===void 0&&(r&&r(0,1),o)){var h=de(o(0,1));w.push(h,h)}var m=()=>1-s,i=t.animate(w,{duration:T,fill:"forwards"});return i.onfinish=()=>{i.cancel();var d=(a==null?void 0:a.t())??1-s;a==null||a.abort();var C=s-d,F=e.duration*Math.abs(C),j=[];if(F>0){var M=!1;if(o)for(var N=Math.ceil(F/16.666666666666668),L=0;L<=N;L+=1){var P=d+C*g(L/N),E=de(o(P,1-P));j.push(E),M||(M=E.overflow==="hidden")}M&&(t.style.overflow="hidden"),m=()=>{var A=i.currentTime;return d+C*g(A/F)},r&&De(()=>{if(i.playState!=="running")return!1;var A=m();return r(A,1-A),!0})}i=t.animate(j,{duration:F,fill:"forwards"}),i.onfinish=()=>{m=()=>s,r==null||r(s,1-s),n()}},{abort:()=>{i&&(i.cancel(),i.effect=null,i.onfinish=B)},deactivate:()=>{n=B},reset:()=>{s===0&&(r==null||r(1,0))},t:()=>m()}}const He=t=>t;function Xe(t,{delay:e=0,duration:a=400,easing:s=He}={}){const n=+getComputedStyle(t).opacity;return{delay:e,duration:a,easing:s,css:l=>`opacity: ${l*n}`}}var $e=ce('<g class="label-feature"><text stroke-linejoin="round"><!></text><text><!></text></g>'),et=ce('<g class="map-layer label-layer"></g>');function tt(t,e){ze(e,!1);const[a,s]=Ne(),n=()=>K(T,"$projection",a),l=()=>K(r,"$transform",a),f=()=>K(o,"$globalFeatures",a),x=We(),{projection:T,features:o,transform:r,handleLayerClick:g,handleLayerMousemove:w}=Le("map");let h=b(e,"features",8,void 0),m=b(e,"fontColor",24,()=>ne.white),i=b(e,"fontSize",8,12),d=b(e,"stroke",24,()=>ne.black),C=b(e,"strokeWidth",8,3),F=b(e,"textAnchor",8,"middle"),j=b(e,"dy",8,"-.5em"),M=b(e,"minZoom",8,0),N=b(e,"pointerEvents",8,!0),L=b(e,"getLabel",8,c=>c),P=b(e,"tooltip",8,!1);const E=Ae();function A(c,u){le(c.target),P()&&w(fe(c,u)),E("mousemove",{e:c,props:u.properties})}function pe(c,u){le(c.target),P()&&g(fe(c,u)),E("click",{e:c,props:u.properties})}Te(()=>n(),()=>{Oe(x,Ke(n()))}),je(),Ie();var Y=Me(),ye=Pe(Y);{var ve=c=>{var u=et();let H;Re(u,5,()=>h()||f(),Ze,(Z,S)=>{var X=$e();const O=D(()=>{const[k,z]=y(x).centroid(y(S));return{x:k,y:z}});var p=U(X);v(p,"opacity",.5);let $;var be=U(p);se(be,e,"default",{get props(){return y(S).properties}},k=>{var z=re();W(I=>oe(z,I),[()=>L()(y(S))],D),G(k,z)});var V=qe(p);let ee;var me=U(V);se(me,e,"default",{get props(){return y(S).properties}},k=>{var z=re();W(I=>oe(z,I),[()=>L()(y(S))],D),G(k,z)}),W(()=>{v(p,"x",y(O).x),v(p,"y",y(O).y),v(p,"dy",j()),v(p,"stroke-width",`${C()/l().k}px`),v(p,"stroke",d()),v(p,"text-anchor",F()),$=J(p,"",$,{"font-size":`${i()/l().k}px`}),v(V,"x",y(O).x),v(V,"y",y(O).y),v(V,"dy",j()),v(V,"fill",m()),v(V,"text-anchor",F()),ee=J(V,"",ee,{"font-size":`${i()/l().k}px`})}),q("mousemove",p,k=>A(k,y(S))),q("click",p,k=>pe(k,y(S))),G(Z,X)}),W(()=>H=J(u,"",H,{"pointer-events":N()?"auto":"none"})),q("mouseout",u,Z=>E("mouseout")),q("blur",u,Z=>E("mouseout")),Ye(3,u,()=>Xe,()=>({duration:250})),G(c,u)};Be(ye,c=>{(!M()||l().k>=M())&&c(ve)})}G(t,Y),Ge(),s()}tt.__docgen={data:[{name:"features",visibility:"public",description:"A list of GeoJSON features. By default this component will render the features set in the parent SVGMap, but if `features` is defined, it plots those instead. Features are rendered as SVG `text` elements. Polygon features are converted to points with `d3.geoPath().centroid`.\n[features]",keywords:[],kind:"let",type:{kind:"type",type:"array",text:"any[]"},static:!1,readonly:!1},{name:"fontColor",visibility:"public",description:`Color of the text label
[fontColor=urbanColors.white]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"fontSize",visibility:"public",description:`Font size of the text label
[fontSize=12]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"12"},{name:"stroke",visibility:"public",description:`Color of the text label outline
[stroke=urbanColors.black]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"strokeWidth",visibility:"public",description:`Width of the outline of the text label
[strokeWidth=3]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"3"},{name:"textAnchor",visibility:"public",description:`Text anchor property of the label
[textAnchor="middle"]`,keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"middle"'},{name:"dy",visibility:"public",description:'`dy` property of the label\n[dy="-.5em"]',keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"-.5em"'},{name:"minZoom",visibility:"public",description:`Minumum zoom factor at which to render layer relative to the default zoom
[minZoom = 0]`,keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"0"},{name:"pointerEvents",visibility:"public",description:`Boolean that determines if this layer should respond to pointer events and dispatch events.
[pointerEvents]`,keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"true"},{name:"getLabel",visibility:"public",description:"Function that returns the string to be displayed in the label when passed a feature object",keywords:[],kind:"let",type:{kind:"function",text:"(d: Object) => string"},static:!1,readonly:!1,defaultValue:"function"},{name:"tooltip",visibility:"public",description:`Boolean that determines if this layer should populate the tooltip slot when interacted with.
[tooltip = false]`,keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"}],name:"SVGLabelLayer.svelte"};export{tt as S};
